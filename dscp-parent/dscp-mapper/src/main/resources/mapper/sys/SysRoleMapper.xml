<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.topideal.dscp.mapper.sys.SysRoleMapper">

    <select id="findPage" resultType="SysRoleRespDto">
        select id, name, discription from sys_role where deleted = 0
        <if test='query.id!=null and !"".equals(query.id)'>
            and id = #{query.id}
        </if>
        <if test='query.name!=null and !"".equals(query.name)'>
            and name like '%${query.name}%'
        </if>
        order by create_time desc
    </select>

    <!--根据用户id查询拥有的角色(包括所有角色) -->
    <select id="findRoleByUserId" resultType="SysRoleRespDto">
        select r.*, if(ur.id is null, false, true) isPossess from sys_role r
        left join ref_user_role ur on ur.role_id = r.id
		and ur.user_id = #{userId}
        where r.deleted = 0
        order by r.create_time asc
    </select>
</mapper>